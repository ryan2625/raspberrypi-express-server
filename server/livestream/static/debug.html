<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  Debug file...
  <button id="start_btn">Start Server</button>
  <button id="stop_btn">Stop Server</button>
  <img id="cameraImage" width="640" height="480" alt="Camera feed">
</body>
<script>
  document.getElementById('start_btn').addEventListener('click', async () => {
    await fetch("/start", { method: 'POST' });
  })
  document.getElementById('stop_btn').addEventListener('click', async () => {
    await fetch("/stop", { method: 'POST' });
  });
  const img = document.getElementById('cameraImage')

  const socket = new WebSocket("wss://mjpeg.westbrookpermaban.uk/ws")

  socket.addEventListener("open", (event) => {
    console.log("WebSocket connected")
    socket.send("")
  });

  socket.addEventListener("message", (event) => {
    if (event.data instanceof Blob) {
      const imageUrl = URL.createObjectURL(event.data)

      if (img.src && img.src.startsWith('blob:')) {
        URL.revokeObjectURL(img.src)
      }
      img.src = imageUrl
    }
  });

  socket.addEventListener("error", (event) => {
    console.error("WebSocket error:", event)
  });
</script>

</html>